{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 42fb9c378a62fe7c56a5","webpack:///./src/arr-stat.js","webpack:///./src/index.js"],"names":["arr","max","array","Math","apply","min","range","midrange","sum","num","i","l","length","mean","median","sort","a","b","mid","modes","modeMap","maxCount","forEach","val","push","variance","map","pow","standardDeviation","sqrt","meanAbsoluteDeviation","abs","zScores","average","stat","INTERVAL","now","window","performance","Date","FPSMeasurer","opts","options","framesCounter","lastFPSTimestamp","lastFPSMeasure","measurements","lastMeasurementTimestamp","started","time","updateFPS","isNaN","setTimeout","stopMeasuring","bind","last","timestamp","delta","fps","round","recordMeasurement","copy","slice","getMeasurements","report","Number","toFixed","stdDev","FPSControl","className","measurer","countRenderBound","registerRenderFrame","updateFPSCounterBound","updateFPSCounter","getLastMeasurement","_container","innerHTML","_map","document","createElement","addEventListeners","startMeasuring","onRemove","removeEventListeners","remove","on","off"],"mappings":"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","file":"MapboxFPS.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"MapboxFPS\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MapboxFPS\"] = factory();\n\telse\n\t\troot[\"MapboxFPS\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 42fb9c378a62fe7c56a5","var arr = {\n    max: function(array) {\n        return Math.max.apply(null, array);\n    },\n\n    min: function(array) {\n        return Math.min.apply(null, array);\n    },\n\n    range: function(array) {\n        return arr.max(array) - arr.min(array);\n    },\n\n    midrange: function(array) {\n        return arr.range(array) / 2;\n    },\n\n    sum: function(array) {\n        var num = 0;\n        for (var i = 0, l = array.length; i < l; i++) num += array[i];\n        return num;\n    },\n\n    mean: function(array) {\n        return arr.sum(array) / array.length;\n    },\n\n    median: function(array) {\n        array.sort(function(a, b) {\n            return a - b;\n        });\n        var mid = array.length / 2;\n        return mid % 1 ? array[mid - 0.5] : (array[mid - 1] + array[mid]) / 2;\n    },\n\n    modes: function(array) {\n        if (!array.length) return [];\n        var modeMap = {},\n            maxCount = 0,\n            modes = [];\n\n        array.forEach(function(val) {\n            if (!modeMap[val]) modeMap[val] = 1;\n            else modeMap[val]++;\n\n            if (modeMap[val] > maxCount) {\n                modes = [val];\n                maxCount = modeMap[val];\n            }else if (modeMap[val] === maxCount) {\n                modes.push(val);\n                maxCount = modeMap[val];\n            }\n        });\n        return modes;\n    },\n\n    variance: function(array) {\n        var mean = arr.mean(array);\n        return arr.mean(array.map(function(num) {\n            return Math.pow(num - mean, 2);\n        }));\n    },\n\n    standardDeviation: function(array) {\n        return Math.sqrt(arr.variance(array));\n    },\n\n    meanAbsoluteDeviation: function(array) {\n        var mean = arr.mean(array);\n        return arr.mean(array.map(function(num) {\n            return Math.abs(num - mean);\n        }));\n    },\n\n    zScores: function(array) {\n        var mean = arr.mean(array);\n        var standardDeviation = arr.standardDeviation(array);\n        return array.map(function(num) {\n            return (num - mean) / standardDeviation;\n        });\n    }\n};\narr.average = arr.mean;\n\nexport default arr;\n\n\n\n// WEBPACK FOOTER //\n// ./src/arr-stat.js","/*\n    by Dag Jomar Mersland\n    @dagjomar\n*/\n\nconst INTERVAL = 500;\n\nimport * as stat from './arr-stat.js';\n\nconst now = function(){\n    if( window && window.performance ){\n        return window.performance.now();\n    }\n\n    return Date.now();\n};\n\nexport class FPSMeasurer {\n    constructor ( opts = {} ) {\n\n        this.options = opts;\n\n        this.framesCounter = 0;\n        this.lastFPSTimestamp = null;\n        this.lastFPSMeasure = 0;\n\n        this.measurements = [];\n        this.lastMeasurementTimestamp = null;\n\n        this.started = false;\n    }\n\n    startMeasuring ( time ){\n        this.started = true;\n        this.updateFPS();\n\n        if(time && !isNaN(time) && time > 0){\n            setTimeout( this.stopMeasuring.bind(this), time);\n        }\n    }\n\n    stopMeasuring (){\n        this.started = false;\n    }\n\n    registerRenderFrame (){\n        if(!this.started){ return; }\n\n        this.framesCounter++;\n        this.updateFPS();\n    }\n\n    getLastMeasurement (){\n        var last = this.measurements.length ? this.measurements[ this.measurements.length - 1 ] : 0;\n        return last;\n    }\n\n    updateFPS (){\n        if(this.lastFPSTimestamp === null){\n            this.lastFPSTimestamp = now();\n        }\n        var timestamp = now(); //console.log('@@ updateFPS', timestamp, this);\n        var delta = timestamp - this.lastFPSTimestamp;\n\n        if(delta > INTERVAL){\n            var fps = Math.round( ( this.framesCounter / ( delta / 1000 ) ) * 10 ) / 10; // Round to 1 decimal\n            this.lastFPSTimestamp = timestamp;\n            this.framesCounter = 0; // Reset the framesCounter\n\n            this.recordMeasurement( fps, delta );\n        }\n    }\n\n    recordMeasurement (fps, delta){\n        this.measurements.push(fps);\n    }\n\n    getMeasurements (){\n        var copy = this.measurements.slice();\n        return copy;\n        //return [1, 2, 3];\n    }\n\n    getMeasurementsReport (){\n        var measurements = this.getMeasurements();\n        var report = {\n            measurements: measurements,\n            median: Number( stat.median(measurements).toFixed(1) ),\n            average: Number( stat.average(measurements).toFixed(1) ),\n            variance: Number( stat.variance(measurements).toFixed(1) ),\n            stdDev: Number( stat.standardDeviation(measurements).toFixed(1) )\n        };\n\n        return report;\n    }\n}\n\nexport class FPSControl{\n    constructor ( opts = { className: 'fps-control' } ) {\n        this.measurer = new FPSMeasurer();\n        this.options = opts;\n\n        this.countRenderBound = this.measurer.registerRenderFrame.bind(this.measurer);\n        this.updateFPSCounterBound = this.updateFPSCounter.bind(this);\n\n        this.lastFPSMeasure = null;\n    }\n\n    updateFPSCounter (){\n        var fps = this.measurer.getLastMeasurement();\n        if(fps === this.lastFPSMeasure){\n            return;\n        }\n        this._container.innerHTML = fps.toFixed(1);\n    }\n\n    onAdd ( map ){\n        this._map = map;\n        this._container = document.createElement('div');\n        this._container.className = this.options.className + ' mapboxgl-ctrl-group mapboxgl-ctrl';\n\n        this.addEventListeners();\n        this.measurer.startMeasuring();\n        return this._container;\n    }\n\n    remove (){\n        this.onRemove();\n    }\n\n    onRemove () {\n        this.removeEventListeners();\n        this.measurer.stopMeasuring();\n        this._container.remove();\n    }\n\n    addEventListeners (){\n        this._map.on('render', this.countRenderBound );\n        this._map.on('render', this.updateFPSCounterBound );\n        // this.updateInterval = setInterval( this.updateFPSCounter.bind(this), 1000);\n    }\n\n    removeEventListeners (){\n        this._map.off('render', this.countRenderBound);\n        this._map.off('render', this.updateFPSCounterBound);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}